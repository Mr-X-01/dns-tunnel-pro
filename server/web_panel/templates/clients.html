{% extends "base.html" %}

{% block title %}–ö–ª–∏–µ–Ω—Ç—ã - DNS Tunnel Pro{% endblock %}

{% block content %}
<h2 style="color: white; margin-bottom: 2rem;">üë• –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–∞–º–∏</h2>

<div class="card">
    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
        <h3>–í—Å–µ –∫–ª–∏–µ–Ω—Ç—ã ({{ clients|length }})</h3>
        <a href="{{ url_for('add_client') }}" class="btn">+ –î–æ–±–∞–≤–∏—Ç—å –∫–ª–∏–µ–Ω—Ç–∞</a>
    </div>
    
    {% if clients %}
    <table>
        <thead>
            <tr>
                <th>–ò–º—è</th>
                <th>Client ID</th>
                <th>–°–æ–∑–¥–∞–Ω</th>
                <th>–°—Ç–∞—Ç—É—Å</th>
                <th>–ü–æ—Å–ª–µ–¥–Ω—è—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å</th>
                <th>‚Üì –û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ</th>
                <th>‚Üë –ü–æ–ª—É—á–µ–Ω–æ</th>
                <th>–î–µ–π—Å—Ç–≤–∏—è</th>
            </tr>
        </thead>
        <tbody>
            {% for client in clients %}
            <tr>
                <td><strong>{{ client.name }}</strong></td>
                <td><code style="font-size: 0.85rem;">{{ client.client_id[:12] }}...</code></td>
                <td>{{ client.created_at.strftime('%Y-%m-%d') }}</td>
                <td>
                    {% if client.is_active %}
                        {% if client.last_seen and (now - client.last_seen).seconds < 300 %}
                            <span class="badge badge-success">‚óè –û–Ω–ª–∞–π–Ω</span>
                        {% else %}
                            <span class="badge badge-warning">‚óã –û—Ñ—Ñ–ª–∞–π–Ω</span>
                        {% endif %}
                    {% else %}
                        <span class="badge badge-danger">‚úï –û—Ç–∫–ª—é—á–µ–Ω</span>
                    {% endif %}
                </td>
                <td>
                    {% if client.last_seen %}
                        {{ client.last_seen.strftime('%Y-%m-%d %H:%M') }}
                    {% else %}
                        -
                    {% endif %}
                </td>
                <td>
                    {% if client.bytes_sent > 1048576 %}
                        {{ "%.1f"|format(client.bytes_sent / 1048576) }} MB
                    {% elif client.bytes_sent > 1024 %}
                        {{ "%.1f"|format(client.bytes_sent / 1024) }} KB
                    {% else %}
                        {{ client.bytes_sent }} B
                    {% endif %}
                </td>
                <td>
                    {% if client.bytes_received > 1048576 %}
                        {{ "%.1f"|format(client.bytes_received / 1048576) }} MB
                    {% elif client.bytes_received > 1024 %}
                        {{ "%.1f"|format(client.bytes_received / 1024) }} KB
                    {% else %}
                        {{ client.bytes_received }} B
                    {% endif %}
                </td>
                <td class="actions">
                    <a href="{{ url_for('client_detail', client_id=client.id) }}" class="btn btn-secondary" style="padding: 0.5rem 1rem; font-size: 0.9rem;">–ü–æ–¥—Ä–æ–±–Ω–µ–µ</a>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% else %}
    <div style="text-align: center; padding: 3rem; color: #95a5a6;">
        <p style="font-size: 1.2rem;">–ù–µ—Ç –∫–ª–∏–µ–Ω—Ç–æ–≤</p>
        <p>–°–æ–∑–¥–∞–π—Ç–µ –ø–µ—Ä–≤–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞ –¥–ª—è –Ω–∞—á–∞–ª–∞ —Ä–∞–±–æ—Ç—ã</p>
        <a href="{{ url_for('add_client') }}" class="btn" style="margin-top: 1rem;">+ –°–æ–∑–¥–∞—Ç—å –∫–ª–∏–µ–Ω—Ç–∞</a>
    </div>
    {% endif %}
</div>
{% endblock %}
